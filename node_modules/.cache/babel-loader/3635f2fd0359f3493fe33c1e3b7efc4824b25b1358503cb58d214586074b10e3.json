{"ast":null,"code":"const Spotify = {\n  accessToken: null,\n  clientId: process.env.REACT_APP_CLIENT_ID,\n  redirectUri: \"http://localhost:3000\",\n  getAccessToken() {\n    if (this.accessToken) {\n      return this.accessToken;\n    }\n    const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\n    const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\n    if (accessTokenMatch && expiresInMatch) {\n      this.accessToken = accessTokenMatch[1];\n      const expiresIn = Number(expiresInMatch[1]);\n      window.setTimeout(() => this.accessToken = \"\", expiresIn * 1000);\n      window.history.pushState(\"Access Token\", null, \"/\");\n      return this.accessToken;\n    } else {\n      const accessUrl = `https://accounts.spotify.com/authorize?client_id=${this.clientId}&response_type=token&scope=playlist-modify-public&redirect_uri=${this.redirectUri}`;\n      window.location = accessUrl;\n    }\n  },\n  async savePlaylist(playlistName, trackUris, onSuccess) {\n    if (!playlistName || !trackUris.length) {\n      return;\n    }\n    const accessToken = Spotify.getAccessToken();\n    const headers = {\n      Authorization: `Bearer ${accessToken}`\n    };\n    try {\n      const response = await fetch(\"https://api.spotify.com/v1/me\", {\n        headers\n      });\n      const userData = await response.json();\n      const userId = userData.id;\n      const createPlaylistResponse = await fetch(`https://api.spotify.com/v1/users/${userId}/playlists`, {\n        headers,\n        method: \"POST\",\n        body: JSON.stringify({\n          name: playlistName,\n          description: \"Custom playlist from PlaylistBuddy\"\n        })\n      });\n      const playlistData = await createPlaylistResponse.json();\n      const playlistId = playlistData.id;\n      await fetch(`https://api.spotify.com/v1/playlists/${playlistId}/tracks`, {\n        headers,\n        method: \"POST\",\n        body: JSON.stringify({\n          uris: trackUris\n        })\n      });\n\n      // Call success function\n      if (onSuccess) {\n        onSuccess(\"Playlist saved successfully!\");\n      }\n    } catch (error) {\n      console.error(\"Error saving playlist:\", error);\n    }\n  }\n};\nexport default Spotify;","map":{"version":3,"names":["Spotify","accessToken","clientId","process","env","REACT_APP_CLIENT_ID","redirectUri","getAccessToken","accessTokenMatch","window","location","href","match","expiresInMatch","expiresIn","Number","setTimeout","history","pushState","accessUrl","savePlaylist","playlistName","trackUris","onSuccess","length","headers","Authorization","response","fetch","userData","json","userId","id","createPlaylistResponse","method","body","JSON","stringify","name","description","playlistData","playlistId","uris","error","console"],"sources":["/Users/sarah/Documents/Projects/React/playlistBuddy/playlistBuddy/src/components/SaveToSpotify.js"],"sourcesContent":["const Spotify = {\n  accessToken: null,\n  clientId: process.env.REACT_APP_CLIENT_ID,\n  redirectUri: \"http://localhost:3000\",\n\n  getAccessToken() {\n    if (this.accessToken) {\n      return this.accessToken;\n    }\n    const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\n    const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\n\n    if (accessTokenMatch && expiresInMatch) {\n      this.accessToken = accessTokenMatch[1];\n      const expiresIn = Number(expiresInMatch[1]);\n\n      window.setTimeout(() => (this.accessToken = \"\"), expiresIn * 1000);\n      window.history.pushState(\"Access Token\", null, \"/\");\n      return this.accessToken;\n    } else {\n      const accessUrl = `https://accounts.spotify.com/authorize?client_id=${this.clientId}&response_type=token&scope=playlist-modify-public&redirect_uri=${this.redirectUri}`;\n      window.location = accessUrl;\n    }\n  },\n\n  async savePlaylist(playlistName, trackUris, onSuccess) {\n    if (!playlistName || !trackUris.length) {\n      return;\n    }\n\n    const accessToken = Spotify.getAccessToken();\n    const headers = { Authorization: `Bearer ${accessToken}` };\n\n    try {\n      const response = await fetch(\"https://api.spotify.com/v1/me\", { headers });\n      const userData = await response.json();\n      const userId = userData.id;\n\n      const createPlaylistResponse = await fetch(\n        `https://api.spotify.com/v1/users/${userId}/playlists`,\n        {\n          headers,\n          method: \"POST\",\n          body: JSON.stringify({ name: playlistName, description: \"Custom playlist from PlaylistBuddy\" }),\n        }\n      );\n      const playlistData = await createPlaylistResponse.json();\n      const playlistId = playlistData.id;\n\n      await fetch(`https://api.spotify.com/v1/playlists/${playlistId}/tracks`, {\n        headers,\n        method: \"POST\",\n        body: JSON.stringify({ uris: trackUris }),\n      });\n\n      // Call success function\n      if (onSuccess) {\n        onSuccess(\"Playlist saved successfully!\");\n      }\n    } catch (error) {\n      console.error(\"Error saving playlist:\", error);\n    }\n  },\n};\n\nexport default Spotify;\n"],"mappings":"AAAA,MAAMA,OAAO,GAAG;EACdC,WAAW,EAAE,IAAI;EACjBC,QAAQ,EAAEC,OAAO,CAACC,GAAG,CAACC,mBAAmB;EACzCC,WAAW,EAAE,uBAAuB;EAEpCC,cAAcA,CAAA,EAAG;IACf,IAAI,IAAI,CAACN,WAAW,EAAE;MACpB,OAAO,IAAI,CAACA,WAAW;IACzB;IACA,MAAMO,gBAAgB,GAAGC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAACC,KAAK,CAAC,sBAAsB,CAAC;IAC3E,MAAMC,cAAc,GAAGJ,MAAM,CAACC,QAAQ,CAACC,IAAI,CAACC,KAAK,CAAC,oBAAoB,CAAC;IAEvE,IAAIJ,gBAAgB,IAAIK,cAAc,EAAE;MACtC,IAAI,CAACZ,WAAW,GAAGO,gBAAgB,CAAC,CAAC,CAAC;MACtC,MAAMM,SAAS,GAAGC,MAAM,CAACF,cAAc,CAAC,CAAC,CAAC,CAAC;MAE3CJ,MAAM,CAACO,UAAU,CAAC,MAAO,IAAI,CAACf,WAAW,GAAG,EAAG,EAAEa,SAAS,GAAG,IAAI,CAAC;MAClEL,MAAM,CAACQ,OAAO,CAACC,SAAS,CAAC,cAAc,EAAE,IAAI,EAAE,GAAG,CAAC;MACnD,OAAO,IAAI,CAACjB,WAAW;IACzB,CAAC,MAAM;MACL,MAAMkB,SAAS,GAAG,oDAAoD,IAAI,CAACjB,QAAQ,kEAAkE,IAAI,CAACI,WAAW,EAAE;MACvKG,MAAM,CAACC,QAAQ,GAAGS,SAAS;IAC7B;EACF,CAAC;EAED,MAAMC,YAAYA,CAACC,YAAY,EAAEC,SAAS,EAAEC,SAAS,EAAE;IACrD,IAAI,CAACF,YAAY,IAAI,CAACC,SAAS,CAACE,MAAM,EAAE;MACtC;IACF;IAEA,MAAMvB,WAAW,GAAGD,OAAO,CAACO,cAAc,CAAC,CAAC;IAC5C,MAAMkB,OAAO,GAAG;MAAEC,aAAa,EAAE,UAAUzB,WAAW;IAAG,CAAC;IAE1D,IAAI;MACF,MAAM0B,QAAQ,GAAG,MAAMC,KAAK,CAAC,+BAA+B,EAAE;QAAEH;MAAQ,CAAC,CAAC;MAC1E,MAAMI,QAAQ,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;MACtC,MAAMC,MAAM,GAAGF,QAAQ,CAACG,EAAE;MAE1B,MAAMC,sBAAsB,GAAG,MAAML,KAAK,CACxC,oCAAoCG,MAAM,YAAY,EACtD;QACEN,OAAO;QACPS,MAAM,EAAE,MAAM;QACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEC,IAAI,EAAEjB,YAAY;UAAEkB,WAAW,EAAE;QAAqC,CAAC;MAChG,CACF,CAAC;MACD,MAAMC,YAAY,GAAG,MAAMP,sBAAsB,CAACH,IAAI,CAAC,CAAC;MACxD,MAAMW,UAAU,GAAGD,YAAY,CAACR,EAAE;MAElC,MAAMJ,KAAK,CAAC,wCAAwCa,UAAU,SAAS,EAAE;QACvEhB,OAAO;QACPS,MAAM,EAAE,MAAM;QACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEK,IAAI,EAAEpB;QAAU,CAAC;MAC1C,CAAC,CAAC;;MAEF;MACA,IAAIC,SAAS,EAAE;QACbA,SAAS,CAAC,8BAA8B,CAAC;MAC3C;IACF,CAAC,CAAC,OAAOoB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;IAChD;EACF;AACF,CAAC;AAED,eAAe3C,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}